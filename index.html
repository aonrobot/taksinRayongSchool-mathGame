<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Student | Matthayomtaksinrayong School</title>
    <link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css">
    <script src="/components/socket.io/socket.io.js"></script>
    <script src="/components/jquery/dist/jquery.min.js"></script>

    <style>
        .footer{
            //position: absolute;
            //bottom: 0;
            width: 100%;
            //height: 60px;
            line-height: 60px;
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-12" style="margin-top:25px;">
                <img src="/logo.png">
                <h1>run{Math}run!! Game <small>v1.5.0</small></h1>
                <hr>
                <div class="prepare text-center">
                    <h5>üòÜ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡πà‡∏∞</h5>
                    <br>
                    <div class="input-group input-group-lg">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroup-sizing-lg">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà üòç</span>
                        </div>
                        <input id="name" type="text" class="form-control" aria-label="Large" aria-describedby="inputGroup-sizing-sm">
                    </div>
                    <br>
                    <button class="btn btn-primary btn-lg" id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡πå üòÉ</button>
                </div>
                <div class="waitingStart">
                    <h3>Waiting for start game...</h3>
                </div>
                <div class="start">
                    <h3 id="player_name"></h3>
                    <p class="text-danger">‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏î refresh ‡∏´‡∏£‡∏∑‡∏≠ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ô‡∏∞‡∏Ñ‡πà‡∏∞ ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞</p>
                    <div class="problem">
                        <div class="card text-center">
                            <div class="card-header">
                                ‡πÑ‡∏õ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ‡∏Å‡∏±‡∏ô‡πÄ‡∏£‡πá‡∏ß‡∏ß üòÉüòçüòÜ
                            </div>
                            <div class="card-body">
                                <h2 class="card-title" id="problem-title">Special title treatment</h2>
                                <p class="card-text">....</p>
                                <img width="100%" id="problem-img">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="message bottom" style="margin-top:20%"></div>
            </div>
        </div>
    </div>

    <script>
        $('.waitingStart').hide()
        $('.start').hide()
        $('.sorry').hide()

        $(document).ready(function(){
            var socket = io('/student');
            var studentInfo;
            var name = "";
            var clickJoinGame = false;

            $('#startBtn').bind('click', function(){
                var id = socket.io.engine.id
                name = $('#name').val()

                if(name === ""){
                    $('.message').empty().append('<div class="alert alert-warning" role="alert">\
                                                    ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏ô‡∏∞‡∏Ñ‡∏∞\
                                                   </div>')
                }else{
                    studentInfo = {id : '/student#'+id, name : name}
                    socket.emit('student', studentInfo)
                    clickJoinGame = true;
                    $('.prepare').hide()
                    $('.message').empty()
                    $('.waitingStart').show()
                }
            })

            socket.on('gameStatus', function(data){
                console.log('Now game status is -> ', data.status)
                if(data.status === 'playing'){

                    if(!clickJoinGame){
                        $('.prepare').hide()
                        $('.waitingStart').hide()
                        $('.message').empty().append('<div class="alert alert-warning" role="alert">\
                                                    ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏°‡∏™‡πå‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ô‡∏∞‡∏Ñ‡∏£‡πâ‡∏≤‡∏≤ >.<\
                                                   </div>')
                    }else{
                        $('.prepare').hide()
                        $('.waitingStart').hide()
                        $('.start').show()
                        $('#player_name').html('<small>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà </small> ' + name)
                    }
                    
                }else if(data.status === 'stop'){
                    $('.start').hide()
                    $('.sorry').hide()
                    $('.waitingStart').hide()
                    clickJoinGame = false;

                    $('.prepare').show()
                    $('.message').empty().append('<div class="alert alert-success" role="alert">\
                                                    ‡πÄ‡∏Å‡∏°‡∏™‡πå‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏ß‡∏£‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÜ‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞‡πÄ‡∏î‡πá‡∏Å‡πÜ\
                                                   </div>')
                }else if(data.status === 'disconnect'){
                    $('.prepare').hide()
                    $('.waitingStart').hide()
                    clickJoinGame = false;

                    $('.message').empty().append('<div class="alert alert-warning" role="alert">\
                                                    ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÄ‡∏Å‡∏°‡∏™‡πå‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏ô‡∏∞‡∏Ñ‡∏£‡πâ‡∏≤‡∏≤ >.<\
                                                   </div>')
                }
            })

            socket.on('problem', function(data) {
                var problem = data.problem
                var p_title = $('#problem-title')
                var p_img = $('#problem-img')
                if(problem.type == 'question'){
                    p_title.html(problem.question_title)
                    p_img.attr('src', '/question_images/' + problem.question_img)
                    p_img.show()
                }else if(problem.type == 'answer'){
                    p_title.html(problem.answer_title)
                    p_img.attr('src', '')                    
                    p_img.hide()
                }
                console.log('problem is -> ', data.problem)
            });

            socket.on('disconnect', function() {
                $('.start').hide()
                $('.waitingStart').hide()
                clickJoinGame = false;

                $('.prepare').show()        
                $('.message').empty().append('<div class="alert alert-danger" role="alert">\
                                                ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Server run{Math}run ‡πÑ‡∏î‡πâ...\
                                              </div>')
            });
            socket.on('connect', function() {
                clickJoinGame = false;
                $('.message').empty().append('<div class="alert alert-success" role="alert">\
                                                ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Server run{Math}run ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏ß ^^...\
                                              </div>')
            });
        })
   </script>
</body>
</html>